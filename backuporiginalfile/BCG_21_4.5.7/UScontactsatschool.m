% Contacts at home: taken from "Projecting contact matrices in 177 
% geographical regions: an update and comparison with empirical data
% for the COVID-19 era" (2020) by Kiesha Prem, Kevin van Zandvoort,
% Petra Klepac, Rosalind M Eggo, Nicholas G Davies, Alex R Cook, Mark Jit

%  0-4  5-9  10-14 15-19 20-24  25-29    30-34   35-39  40-44    45-49  50-54  55-59   60-64   65-69   70-74   75+
Contact_school_USA = [...
0.49424 0.20385 0.03913 0.03906 0.01107 0.00576 0.01433 0.01069 0.00555 0.00655 0.00344 0.00259 0.00041 0.00019 0.00000 0.00000
0.25508 5.84538 0.34805 0.03538 0.03608 0.00595 0.01392 0.01341 0.01537 0.01084 0.00867 0.00301 0.00139 0.00035 0.00007 0.00000
0.00227 1.35125 8.39385 0.23905 0.02469 0.00484 0.00893 0.01449 0.01792 0.01390 0.00924 0.00520 0.00155 0.00019 0.00000 0.00004
0.01252 0.05320 2.39561 7.54026 0.09351 0.00511 0.01028 0.01472 0.01466 0.01708 0.00895 0.00595 0.00160 0.00027 0.00000 0.00000
0.01488 0.02885 0.01224 0.95641 0.43521 0.00495 0.00490 0.00609 0.00444 0.00545 0.00280 0.00215 0.00018 0.00029 0.00004 0.00000
0.00186 0.00829 0.00272 0.01306 0.02740 0.01093 0.00199 0.00267 0.00326 0.00287 0.00080 0.00147 0.00060 0.00043 0.00009 0.00026
0.00505 0.04972 0.03468 0.02045 0.00738 0.00622 0.00606 0.00427 0.00482 0.00253 0.00218 0.00037 0.00081 0.00008 0.00000 0.00000
0.00860 0.02991 0.02310 0.01086 0.00294 0.00406 0.00607 0.00461 0.00533 0.00257 0.00040 0.00105 0.00009 0.00038 0.00000 0.00000
0.00308 0.02036 0.01707 0.06356 0.00162 0.00209 0.00222 0.00305 0.00685 0.00246 0.00289 0.00090 0.00089 0.00009 0.00000 0.00000
0.02575 0.04545 0.03110 0.10245 0.00117 0.00262 0.00547 0.00480 0.00469 0.00284 0.00367 0.00189 0.00054 0.00032 0.00000 0.00000
0.00626 0.07108 0.09374 0.09265 0.00114 0.00141 0.00423 0.00424 0.00551 0.00758 0.00404 0.00240 0.00078 0.00000 0.00000 0.00000
0.02146 0.07434 0.06777 0.07132 0.00141 0.00613 0.00254 0.00433 0.00567 0.00413 0.00377 0.00462 0.00162 0.00000 0.00016 0.00015
0.01160 0.01733 0.00926 0.04068 0.00325 0.00024 0.00232 0.00654 0.00148 0.00237 0.00192 0.00105 0.00392 0.00219 0.00000 0.00000
0.00040 0.00692 0.00276 0.00000 0.00045 0.00034 0.00224 0.00099 0.00100 0.00162 0.00037 0.00290 0.00160 0.00348 0.00222 0.00000
0.00000 0.00000 0.00000 0.00152 0.00000 0.00000 0.00000 0.00152 0.00157 0.00423 0.00704 0.00429 0.00155 0.00160 0.00158 0.00428
0.00000 0.00422 0.00000 0.00424 0.00000 0.00152 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000...
];


%  0-4  5-9  10-14 15-19 20-24  25-29    30-34   35-39  40-44    45-49  50-54  55-59   60-64   65-69   70-74   75+
schoolpart_USA = [ 0.2584049 0.8862131 0.9332066 0.9073709 0.3635226 0.01262512 0.03064443 0.03065999 0.03797611 0.03758819 0.03162339 0.02900321 0.02307875 0.007977091     0     0];

% if the model does not feature school participation explicitly, the
% aggregate contacts are
% aggregating to 3 age groups: young (0-19), middle (20-64), old (65+)
Contact_school_agg_3 = ...
[sum(sum(Contact_school_USA(1:4,1:4),2).*popsharebyage(1:4)')/sum(popsharebyage(1:4)),...
 sum(sum(Contact_school_USA(1:4,5:13),2).*popsharebyage(1:4)')/sum(popsharebyage(1:4)),...
 sum(sum(Contact_school_USA(1:4,14:16),2).*popsharebyage(1:4)')/sum(popsharebyage(1:4));...
 sum(sum(Contact_school_USA(5:13,1:4),2).*popsharebyage(5:13)')/sum(popsharebyage(5:13)),...
 sum(sum(Contact_school_USA(5:13,5:13),2).*popsharebyage(5:13)')/sum(popsharebyage(5:13)),...
 sum(sum(Contact_school_USA(5:13,14:16),2).*popsharebyage(5:13)')/sum(popsharebyage(5:13));...
 sum(sum(Contact_school_USA(14:16,1:4),2).*popsharebyage(14:16)')/sum(popsharebyage(14:16)),...
 sum(sum(Contact_school_USA(14:16,5:13),2).*popsharebyage(14:16)')/sum(popsharebyage(14:16)),...
 sum(sum(Contact_school_USA(14:16,14:16),2).*popsharebyage(14:16)')/sum(popsharebyage(14:16))];

% aggregate
Contact_school_agg_1 = ...
[sum(sum(Contact_school_USA(1:16,1:16),2).*popsharebyage(1:16)')/sum(popsharebyage(1:16))];

